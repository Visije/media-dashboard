<!DOCTYPE html>
<html>
<head>
  <title>Script Tracker</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    body {
      background: #f7f8fc;
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }
    .channel-card {
      background: white;
      margin-bottom: 30px;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    .channel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .channel-header h2 {
      margin: 0;
      font-size: 22px;
      color: #2a2a2a;
    }
    .progress-bar {
      background: #e3e6ef;
      border-radius: 8px;
      overflow: hidden;
      height: 10px;
      margin-top: 8px;
    }
    .progress-bar-inner {
      height: 100%;
      background: #6c5ce7;
      transition: width 0.3s ease;
    }
    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    input, select {
      padding: 8px 10px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 14px;
      outline: none;
    }
    input:focus, select:focus {
      border-color: #6c5ce7;
      box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.15);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #f0f0f0;
      font-size: 15px;
    }
    th {
      color: #444;
      font-weight: 600;
    }
    .badge {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 600;
      color: white;
      display: inline-block;
    }
    .Ready { background: #00b894; }
    .Writing { background: #fdcb6e; }
    .Pending { background: #d63031; }
  </style>
</head>
<body>

  <nav>
  <a href="index.html">üè† Dashboard</a>
  <a href="scripts.html">‚úçÔ∏è Scripts</a>
  <a href="calendar.html">üìÖ Calendar</a>
  <a href="goals.html">üéØ Daily Goals</a>
</nav>

  <script>
  const role = localStorage.getItem("role");

  if (role !== "writer" && role !== "admin") {
    window.location.href = "index.html";
  }
</script>

<h1>‚úçÔ∏è Script Tracker (Ascend Style)</h1>

<div id="tables"></div>

<script>
const sheetURL = "PASTE_SCRIPTS_CSV_URL";

const channels = [
  "Ender Vij",
  "I'm Gurey",
  "CRUST",
  "Zone-out History",
  "Touristico"
];

function parseCSV(text) {
  return text.trim().split("\n").slice(1).map(r => r.split(","));
}

fetch(sheetURL)
  .then(res => res.text())
  .then(text => {
    const rows = parseCSV(text);
    const container = document.getElementById("tables");

    channels.forEach(channel => {
      const channelRows = rows.filter(r => r[1] === channel);
      const completedCount = channelRows.filter(r => r[2] === "Ready").length;
      const percentComplete = channelRows.length
        ? Math.round((completedCount / channelRows.length) * 100)
        : 0;

      const card = document.createElement("div");
      card.className = "channel-card";
card.innerHTML = `
  <div class="channel-header">
    <h2>${channel}</h2>
    <div>${percentComplete}% Completed</div>
  </div>

  <div class="progress-bar">
    <div class="progress-bar-inner" style="width: ${percentComplete}%;"></div>
  </div>

  <div style="margin-top:6px;font-size:13px;opacity:0.8;">
    ${completedCount} / ${channelRows.length} scripts ready
  </div>
`;

        <div class="controls">
          <input placeholder="Search title" onkeyup="filterTable(this)">
          <select onchange="sortTable(this)">
            <option value="date_desc">Newest</option>
            <option value="date_asc">Oldest</option>
            <option value="words">Words</option>
          </select>
        </div>

        <table>
          <tr>
            <th>Title</th>
            <th>Status</th>
            <th>Words</th>
            <th>Date</th>
          </tr>
          ${channelRows.map(r => `
            <tr>
              <td>${r[0]}</td>
              <td><span class="badge ${r[2]}">${r[2]}</span></td>
              <td>${r[3]}</td>
              <td>${r[4]}</td>
            </tr>
          `).join("")}
        </table>
      `;
      container.appendChild(card);
    });
  });

function filterTable(input) {
  const rows = input.closest(".channel-card").querySelectorAll("table tr");
  rows.forEach((row, i) => {
    if (i === 0) return;
    row.style.display = row.children[0].innerText
      .toLowerCase()
      .includes(input.value.toLowerCase()) ? "" : "none";
  });
}

function sortTable(select) {
  const table = select.closest(".channel-card").querySelector("table");
  const rows = Array.from(table.rows).slice(1);

  rows.sort((a, b) => {
    if (select.value === "words")
      return b.cells[2].innerText - a.cells[2].innerText;
    if (select.value === "date_asc")
      return new Date(a.cells[3].innerText) - new Date(b.cells[3].innerText);
    return new Date(b.cells[3].innerText) - new Date(a.cells[3].innerText);
  });

  rows.forEach(r => table.appendChild(r));
}
</script>

<script>
function toggleTheme() {
  document.body.classList.toggle("dark");

  localStorage.setItem(
    "theme",
    document.body.classList.contains("dark") ? "dark" : "light"
  );
}

// Apply saved theme on page load
if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark");
}
</script>

</body>
</html>




