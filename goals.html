<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Weekly Goals & Habit Tracker</title>
<link rel="stylesheet" href="css/style.css">

<style>
body {
  background:#f5f7fb;
  font-family:"Segoe UI",system-ui,sans-serif;
}

.wrapper {
  max-width: 1000px;
  margin: 40px auto;
  padding: 0 16px;
}

h1 { margin-bottom: 6px; }
.subtitle { color:#666; margin-bottom:20px; }

.card {
  background:#fff;
  border-radius:16px;
  padding:18px;
  box-shadow:0 6px 18px rgba(0,0,0,.06);
}

table {
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}

th, td {
  padding:10px;
  text-align:center;
  font-size:15px;
}

th {
  font-weight:600;
  color:#444;
}

td:first-child, th:first-child {
  text-align:left;
}

input[type="checkbox"] {
  transform: scale(1.2);
  cursor:pointer;
}

.streak {
  font-weight:600;
  color:#e17055;
}

.progress-box {
  margin-top:20px;
  text-align:center;
}

progress {
  width:100%;
  height:14px;
  margin-top:8px;
  border-radius:10px;
}

progress::-webkit-progress-bar {
  background:#e6e9f2;
}

progress::-webkit-progress-value {
  background:#6c5ce7;
}
</style>
</head>

<body>

<nav class="main-nav">
  <a href="index.html">Dashboard</a>
  <a href="calendar.html">Calendar</a>
  <a href="scripts.html">Scripts</a>
  <a href="goals.html" class="active">Goals</a>
</nav>

<div class="wrapper">

<h1>ðŸ“… Weekly Habit Tracker</h1>
<p class="subtitle">Monâ€“Sun execution with streaks (Ascend style)</p>

<div class="card">

<table id="habitTable">
<thead>
<tr>
  <th>Habit</th>
  <th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th>
  <th>ðŸ”¥ Streak</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="progress-box">
  <strong id="weeklyPercent">0% completed</strong>
  <progress id="weeklyProgress" value="0" max="1"></progress>
</div>

</div>
</div>

<script>
/* ===== CONFIG ===== */
const habits = [
  "Wake up before 6",
  "No alcohol",
  "Cold shower",
  "1 hour no social media",
  "Gym / Workout",
  "Reading",
  "Learning / Skill"
];

const days = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
const weekKey = getWeekKey();

/* ===== STORAGE ===== */
let data = JSON.parse(localStorage.getItem("weeklyHabits")) || {};
if (!data[weekKey]) data[weekKey] = {};
habits.forEach(h => {
  if (!data[weekKey][h]) data[weekKey][h] = Array(7).fill(false);
});

/* ===== BUILD TABLE ===== */
const tbody = document.querySelector("#habitTable tbody");

habits.forEach((habit, hIndex) => {
  const tr = document.createElement("tr");

  tr.innerHTML = `<td>${habit}</td>`;

  days.forEach((_, dIndex) => {
    const td = document.createElement("td");
    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.checked = data[weekKey][habit][dIndex];

    cb.addEventListener("change", () => {
      data[weekKey][habit][dIndex] = cb.checked;
      localStorage.setItem("weeklyHabits", JSON.stringify(data));
      updateStats();
    });

    td.appendChild(cb);
    tr.appendChild(td);
  });

  const streakTd = document.createElement("td");
  streakTd.className = "streak";
  streakTd.id = `streak-${hIndex}`;
  tr.appendChild(streakTd);

  tbody.appendChild(tr);
});

/* ===== HELPERS ===== */
function getWeekKey() {
  const d = new Date();
  const onejan = new Date(d.getFullYear(),0,1);
  const week = Math.ceil((((d - onejan) / 86400000) + onejan.getDay()+1)/7);
  return `${d.getFullYear()}-W${week}`;
}

function calculateStreak(arr) {
  let streak = 0;
  for (let i = arr.length - 1; i >= 0; i--) {
    if (arr[i]) streak++;
    else break;
  }
  return streak;
}

/* ===== UPDATE STATS ===== */
function updateStats() {
  let total = habits.length * 7;
  let done = 0;

  habits.forEach((habit, i) => {
    const arr = data[weekKey][habit];
    arr.forEach(v => v && done++);

    document.getElementById(`streak-${i}`).innerText =
      calculateStreak(arr) + "ðŸ”¥";
  });

  const percent = Math.round((done / total) * 100);
  document.getElementById("weeklyPercent").innerText =
    `${percent}% completed`;
  document.getElementById("weeklyProgress").max = total;
  document.getElementById("weeklyProgress").value = done;
}

updateStats();
</script>

</body>
</html>
